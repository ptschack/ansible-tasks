- name: check if raspbian
  shell: cat /etc/os-release | grep 'ID=raspbian'
  register: os_raspbian
  ignore_errors: yes

- include_tasks: Raspbian.yml
  when: os_raspbian.rc == 0

- name: "perform Debian tasks"
  block:

  - name: install keyrings
    become: yes
    package:
      name: "{{ item }}"
      state: latest
    with_items:
      - debian-keyring
      - debian-archive-keyring

  - name: add repositories
    become: yes
    lineinfile:
      line: "{{ item }}"
      path: /etc/apt/sources.list
    with_items:
      - 'deb http://ftp.de.debian.org/debian/ stable main contrib non-free'
      - 'deb http://security.debian.org/ stable/updates main contrib non-free'
      - 'deb http://ftp.de.debian.org/debian/ stable-updates main contrib non-free'
      - 'deb http://deb.debian.org/debian {{ ansible_distribution_release }}-backports main contrib'

  when: os_raspbian.rc != 0